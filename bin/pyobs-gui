#!/usr/bin/env python3.6
import argparse
import logging
import sys
from PyQt5 import QtWidgets

from pyobs.comm.xmpp import XmppComm
from pyobs_gui.mainwindow import MainWindow

if __name__ == '__main__':
    # logger
    logging.basicConfig(level=logging.INFO, format='%(asctime)s [%(levelname)s] %(filename)s:%(lineno)d %(message)s')

    # argparse
    parser = argparse.ArgumentParser()
    parser.add_argument('jid', type=str, help='Jabber ID to connect as')
    parser.add_argument('password', type=str, help='Password for given JID')
    parser.add_argument('-s', '--server', type=str, help='Server to connect to')
    args = parser.parse_args()

    # create object and open it
    comm = XmppComm(jid=args.jid, password=args.password, server=args.server)
    comm.open()

    # create app
    app = QtWidgets.QApplication(sys.argv)

    # create and show window
    window = MainWindow(comm)
    window.show()

    # run
    app.exec()

    # close xmpp
    comm.close()
